============================= test session starts =============================
platform win32 -- Python 3.13.9, pytest-8.4.2, pluggy-1.6.0
benchmark: 5.2.2 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)
rootdir: B:\GH\GeomPrimitive\primitives
configfile: pytest.ini
testpaths: tests
plugins: anyio-4.11.0, dash-3.2.0, benchmark-5.2.2, cov-7.0.0
collected 63 items

tests\test_mpl_path_utils.py ....FFF....F..                              [ 22%]
tests\test_spt_color.py .......                                          [ 33%]
tests\test_spt_geometry.py .........                                     [ 47%]
tests\test_spt_lighting.py ..........                                    [ 63%]
tests\test_spt_noise.py ........x.                                       [ 79%]
tests\test_spt_texture.py ............s                                  [100%]

================================== FAILURES ===================================
__________________ test_angle_offset_rotates_major_axis[0.0] __________________

angle_offset = 0.0

    @pytest.mark.parametrize("angle_offset", [0.0, 30.0, 90.0])
    def test_angle_offset_rotates_major_axis(angle_offset):
        """Rotation should affect vertex bounding box orientation."""
        path1 = ellipse_or_arc_path(0, 0, 1.0, y_compress=0.5, angle_offset=angle_offset)
        verts = path1.vertices
>       x_span = verts[:, 0].ptp()
                 ^^^^^^^^^^^^^^^
E       AttributeError: `ptp` was removed from the ndarray class in NumPy 2.0. Use np.ptp(arr, ...) instead.

tests\test_mpl_path_utils.py:82: AttributeError
_________________ test_angle_offset_rotates_major_axis[30.0] __________________

angle_offset = 30.0

    @pytest.mark.parametrize("angle_offset", [0.0, 30.0, 90.0])
    def test_angle_offset_rotates_major_axis(angle_offset):
        """Rotation should affect vertex bounding box orientation."""
        path1 = ellipse_or_arc_path(0, 0, 1.0, y_compress=0.5, angle_offset=angle_offset)
        verts = path1.vertices
>       x_span = verts[:, 0].ptp()
                 ^^^^^^^^^^^^^^^
E       AttributeError: `ptp` was removed from the ndarray class in NumPy 2.0. Use np.ptp(arr, ...) instead.

tests\test_mpl_path_utils.py:82: AttributeError
_________________ test_angle_offset_rotates_major_axis[90.0] __________________

angle_offset = 90.0

    @pytest.mark.parametrize("angle_offset", [0.0, 30.0, 90.0])
    def test_angle_offset_rotates_major_axis(angle_offset):
        """Rotation should affect vertex bounding box orientation."""
        path1 = ellipse_or_arc_path(0, 0, 1.0, y_compress=0.5, angle_offset=angle_offset)
        verts = path1.vertices
>       x_span = verts[:, 0].ptp()
                 ^^^^^^^^^^^^^^^
E       AttributeError: `ptp` was removed from the ndarray class in NumPy 2.0. Use np.ptp(arr, ...) instead.

tests\test_mpl_path_utils.py:82: AttributeError
_____________________ test_join_paths_handles_none_codes ______________________

    def test_join_paths_handles_none_codes():
        """join_paths must safely handle Path objects with codes=None."""
        p1 = mplPath([[0, 0], [1, 1]])
        p2 = mplPath([[1, 1], [2, 2]])
>       joined = join_paths([p1, p2])
                 ^^^^^^^^^^^^^^^^^^^^

tests\test_mpl_path_utils.py:132: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

paths = [Path(array([[0., 0.],
       [1., 1.]]), None), Path(array([[1., 1.],
       [2., 2.]]), None)]
preserve_moveto = False

    def join_paths(paths: list[mplPath], preserve_moveto: bool = False) -> mplPath:
        """
        Join multiple Matplotlib ``Path`` objects into a single composite path.
    
        Args:
            paths (list[matplotlib.path.Path]):
                Input list of path objects to join.
            preserve_moveto (bool, optional):
                Whether to keep the initial ``MOVETO`` command for each path.
                If ``False`` (default), subsequent paths are joined seamlessly
                into one continuous path.
    
        Returns:
            matplotlib.path.Path:
                The concatenated composite path.
    
        Raises:
            ValueError: If ``paths`` is empty.
            TypeError: If any element of ``paths`` is not a ``Path`` instance.
        """
        if not paths:
            raise ValueError("Expected a non-empty list of Matplotlib paths.")
    
        for path in paths:
            if not isinstance(path, mplPath):
                raise TypeError(f"Expected a list of Matplotlib paths, got {type(path).__name__}.")
    
        verts_list, codes_list = [paths[0].vertices], [paths[0].codes]
    
        start = 0 if preserve_moveto else 1
        for path in paths[1:]:
            if path.vertices.size == 0:
                continue
            verts_list.append(path.vertices[start:])
>           codes_list.append(path.codes[start:])
                              ^^^^^^^^^^^^^^^^^^
E           TypeError: 'NoneType' object is not subscriptable

src\spt\mpl_path_utils.py:79: TypeError

--------------------------------------------------------------------------------------------------- benchmark: 2 tests --------------------------------------------------------------------------------------------------
Name (time in us)                        Min                    Max                   Mean                StdDev                 Median                 IQR            Outliers         OPS            Rounds  Iterations
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
test_perf_benchmark                 132.7000 (1.0)         556.8999 (1.0)         137.7377 (1.0)         13.5019 (1.0)         135.4000 (1.0)        2.1000 (1.0)       103;208  7,260.1789 (1.0)        3280           1
test_runtime_under_threshold     32,146.9001 (242.25)   44,200.8000 (79.37)    33,196.1667 (241.01)   2,252.7195 (166.84)   32,593.5000 (240.72)   463.5000 (220.71)        1;3     30.1240 (0.00)         27           1
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

Legend:
  Outliers: 1 Standard Deviation from Mean; 1.5 IQR (InterQuartile Range) from 1st Quartile and 3rd Quartile.
  OPS: Operations Per Second, computed as 1 / Mean
=========================== short test summary info ===========================
FAILED tests/test_mpl_path_utils.py::test_angle_offset_rotates_major_axis[0.0]
FAILED tests/test_mpl_path_utils.py::test_angle_offset_rotates_major_axis[30.0]
FAILED tests/test_mpl_path_utils.py::test_angle_offset_rotates_major_axis[90.0]
FAILED tests/test_mpl_path_utils.py::test_join_paths_handles_none_codes - Typ...
============= 4 failed, 57 passed, 1 skipped, 1 xfailed in 3.09s ==============
